---
sidebar_position: 14
title: "Aula 14: Perfil do Usu√°rio"
description: "Tela de perfil, consumo de dados do usu√°rio logado e edi√ß√£o de informa√ß√µes."
---

# Aula 14: Perfil do Usu√°rio

:::info üîÄ Branch da Aula
Esta aula refere-se √† branch: **`aula-14`**
```bash
git checkout aula-14
```
:::

## üìñ Conceito

A tela de perfil exibe os dados do usu√°rio autenticado e permite edi√ß√£o de informa√ß√µes pessoais. Os dados v√™m do modelo `User` retornado pelo servidor.

### Modelo User

```kotlin
@Serializable
data class User(
    val id: String,
    val username: String,
    val email: String,
    @SerialName("avatar_url") val avatarUrl: String? = null,
    @SerialName("streak_count") val streakCount: Int = 0,
    @SerialName("longest_streak") val longestStreak: Int = 0,
    @SerialName("streak_freezes") val streakFreezes: Int = 0
)
```

### ProfileScreen com dados reais

```kotlin
@Composable
fun ProfileScreen(viewModel: ProfileViewModel = koinViewModel()) {
    val uiState by viewModel.uiState.collectAsStateWithLifecycle()
    val user = uiState.user

    LazyColumn(modifier = Modifier.fillMaxSize().padding(16.dp)) {
        item {
            // Avatar
            AsyncImage(
                model = user?.avatarUrl,
                contentDescription = "Avatar",
                modifier = Modifier.size(80.dp).clip(CircleShape)
            )
            Spacer(modifier = Modifier.height(16.dp))
            Text(text = user?.username ?: "", style = MaterialTheme.typography.headlineMedium)
            Text(text = user?.email ?: "", color = MaterialTheme.colorScheme.onSurfaceVariant)
        }
    }
}
```

## üíª C√≥digo de Refer√™ncia

```kotlin title="viewmodel/ProfileViewModel.kt"
class ProfileViewModel(
    private val authRepository: AuthRepository
) : ViewModel() {

    data class UiState(
        val user: User? = null,
        val isLoading: Boolean = false
    )

    private val _uiState = MutableStateFlow(UiState())
    val uiState = _uiState.asStateFlow()

    init { loadProfile() }

    private fun loadProfile() {
        viewModelScope.launch {
            _uiState.update { it.copy(isLoading = true) }
            val result = authRepository.getCurrentUser()
            if (result is Result.Success) {
                _uiState.update { it.copy(user = result.data, isLoading = false) }
            }
        }
    }
}
```

## üíª M√£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="Exerc√≠cio 1 ‚Äî Fixa√ß√£o" default>

### Exiba as estat√≠sticas de streak

Na `ProfileScreen`, adicione uma `Row` com 3 cards: üî• `streak_count` (Ofensiva Atual), üèÜ `longest_streak` (Maior Ofensiva), üßä `streak_freezes` (Congelamentos).

  </TabItem>
  <TabItem value="ex2" label="Exerc√≠cio 2 ‚Äî Aplica√ß√£o">

### Implemente a edi√ß√£o de perfil

Crie um bot√£o "Editar Perfil" que abre um di√°logo com campos edit√°veis para `username`. Ao salvar, atualize via API e reflita no estado.

  </TabItem>
  <TabItem value="ex3" label="Exerc√≠cio 3 ‚Äî Desafio">

### Bot√£o de logout funcional

Adicione um bot√£o "Sair" na `ProfileScreen` que chame `authRepository.logout()` (limpa DataStore), navegue para a tela de Login usando `navController.navigate("login") { popUpTo(0) }`, e integre com o fluxo de auth da **Aula 13**.

  </TabItem>
</Tabs>
