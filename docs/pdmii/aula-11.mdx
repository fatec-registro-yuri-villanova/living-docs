---
sidebar_position: 11
title: "Aula 11: Tela de Quiz e Quest√µes"
description: "Renderiza√ß√£o din√¢mica de perguntas, op√ß√µes de resposta e blocos de c√≥digo no quiz."
---

# Aula 11: Tela de Quiz e Quest√µes

:::info üîÄ Branch da Aula
Esta aula refere-se √† branch: **`aula-11`**
```bash
git checkout aula-11
```
:::

## üìñ Conceito

O cora√ß√£o do MergeSkills √© o **Quiz**. Cada li√ß√£o cont√©m perguntas com op√ß√µes de resposta e, frequentemente, blocos de c√≥digo que o aluno precisa analisar.

### Modelo de Quest√£o

```kotlin
@Serializable
data class QuestionDto(
    val id: String,
    val prompt: String,
    @SerialName("code_block")
    val codeBlock: String? = null,  // Pode ter c√≥digo ou n√£o
    val options: List<OptionDto>
)

@Serializable
data class OptionDto(
    val id: String,
    val text: String
    // ‚ö†Ô∏è N√ÉO existe "isCorrect" no cliente! Seguran√ßa: valida√ß√£o √© no servidor
)
```

:::danger Regra de Seguran√ßa
**Nunca exponha `correct_answer` no cliente.** O app envia apenas o `optionId` selecionado para o servidor via `POST /progress/submit`. O servidor retorna se est√° correto ou n√£o.
:::

### Renderiza√ß√£o de C√≥digo

Para exibir blocos de c√≥digo no quiz, use texto com fonte monospace:

```kotlin
@Composable
fun CodeBlock(code: String, modifier: Modifier = Modifier) {
    Surface(
        modifier = modifier.fillMaxWidth(),
        shape = RoundedCornerShape(12.dp),
        color = Color(0xFF1A1A2E)
    ) {
        Text(
            text = code,
            modifier = Modifier.padding(16.dp),
            fontFamily = FontFamily.Monospace,
            fontSize = 14.sp,
            color = Color(0xFFE0E0E0),
            lineHeight = 20.sp
        )
    }
}
```

## üíª C√≥digo de Refer√™ncia

```kotlin title="screens/QuizScreen.kt"
@Composable
fun QuizScreen(
    lessonId: String,
    viewModel: QuizViewModel = koinViewModel { parametersOf(lessonId) }
) {
    val uiState by viewModel.uiState.collectAsStateWithLifecycle()
    val currentQuestion = uiState.currentQuestion

    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp)
    ) {
        // Progresso
        LinearProgressIndicator(
            progress = { uiState.progress },
            modifier = Modifier.fillMaxWidth().clip(RoundedCornerShape(4.dp)),
            color = MaterialTheme.colorScheme.primary
        )

        Spacer(modifier = Modifier.height(24.dp))

        if (currentQuestion != null) {
            // Pergunta
            Text(
                text = currentQuestion.prompt,
                style = MaterialTheme.typography.titleMedium
            )

            // Bloco de c√≥digo (se houver)
            currentQuestion.codeBlock?.let { code ->
                Spacer(modifier = Modifier.height(16.dp))
                CodeBlock(code = code)
            }

            Spacer(modifier = Modifier.height(24.dp))

            // Op√ß√µes de resposta
            currentQuestion.options.forEach { option ->
                OptionButton(
                    text = option.text,
                    isSelected = uiState.selectedOptionId == option.id,
                    onClick = { viewModel.onAction(QuizAction.SelectOption(option.id)) }
                )
                Spacer(modifier = Modifier.height(8.dp))
            }
        }

        Spacer(modifier = Modifier.weight(1f))

        // Bot√£o de confirmar
        StitchButton(
            text = "Confirmar",
            onClick = { viewModel.onAction(QuizAction.Submit) },
            enabled = uiState.selectedOptionId != null
        )
    }
}
```

## üíª M√£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="Exerc√≠cio 1 ‚Äî Fixa√ß√£o" default>

### Estilize o `OptionButton`

Crie um `OptionButton` que mude de cor ao ser selecionado: **N√£o selecionado** ‚Üí borda cinza, fundo transparente. **Selecionado** ‚Üí borda `StitchGreen`, fundo com opacidade verde.

  </TabItem>
  <TabItem value="ex2" label="Exerc√≠cio 2 ‚Äî Aplica√ß√£o">

### Implemente o `QuizViewModel`

Crie o ViewModel com `UiState` (quest√£o atual, op√ß√£o selecionada, progresso), `Actions` (`SelectOption(id)`, `Submit`, `NextQuestion`) e l√≥gica de avan√ßar para a pr√≥xima quest√£o ap√≥s submiss√£o.

  </TabItem>
  <TabItem value="ex3" label="Exerc√≠cio 3 ‚Äî Desafio">

### Quiz com submiss√£o ao servidor

Integre o `QuizViewModel` com o `ProgressRepository` (Aula 09). Ao confirmar, envie `POST /progress/submit` com `{ lessonId, questionId, optionId }`. Receba a resposta do servidor indicando se est√° correto. Mostre feedback visual (verde para acerto, vermelho para erro). Use o `CodeBlock` para quest√µes que cont√™m c√≥digo.

  </TabItem>
</Tabs>
