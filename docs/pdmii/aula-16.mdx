---
sidebar_position: 16
title: "Aula 16: Image Loading com Coil"
description: "Carregamento de imagens remotas com Coil, placeholders, cache e avatares."
---

# Aula 16: Image Loading com Coil

:::info ðŸ”€ Branch da Aula
Esta aula refere-se Ã  branch: **`aula-16`**
```bash
git checkout aula-16
```
:::

## ðŸ“– Conceito

**Coil** (Coroutine Image Loader) Ã© a biblioteca de carregamento de imagens recomendada para Compose. Ã‰ leve, usa Coroutines, e tem integraÃ§Ã£o nativa com Compose.

### AsyncImage

```kotlin
AsyncImage(
    model = ImageRequest.Builder(LocalContext.current)
        .data(user.avatarUrl)
        .crossfade(true)
        .placeholder(R.drawable.avatar_placeholder)
        .error(R.drawable.avatar_default)
        .build(),
    contentDescription = "Avatar do usuÃ¡rio",
    modifier = Modifier.size(80.dp).clip(CircleShape),
    contentScale = ContentScale.Crop
)
```

### Cache e Performance

Coil faz cache automaticamente em disco e memÃ³ria. Para configuraÃ§Ã£o global:

```kotlin
// No Application (ou Koin module)
val imageLoader = ImageLoader.Builder(context)
    .memoryCachePolicy(CachePolicy.ENABLED)
    .diskCachePolicy(CachePolicy.ENABLED)
    .crossfade(true)
    .build()
```

## ðŸ’» CÃ³digo de ReferÃªncia

```kotlin title="components/UserAvatar.kt"
@Composable
fun UserAvatar(
    avatarUrl: String?,
    size: Dp = 48.dp,
    modifier: Modifier = Modifier
) {
    AsyncImage(
        model = ImageRequest.Builder(LocalContext.current)
            .data(avatarUrl)
            .crossfade(300)
            .build(),
        contentDescription = "Avatar",
        modifier = modifier
            .size(size)
            .clip(CircleShape)
            .border(2.dp, MaterialTheme.colorScheme.primary, CircleShape),
        contentScale = ContentScale.Crop,
        placeholder = painterResource(R.drawable.ic_person),
        error = painterResource(R.drawable.ic_person)
    )
}
```

## ðŸ’» MÃ£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>

### Adicione Coil ao projeto

Adicione a dependÃªncia `coil-compose` e substitua qualquer `Image` placeholder pelo `AsyncImage` com a URL real do avatar do usuÃ¡rio.

  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">

### Crie imagens de capa para cursos

Cada curso na lista deve exibir uma imagem de capa usando `AsyncImage`. Use `contentScale = ContentScale.Crop` e `RoundedCornerShape(16.dp)`.

  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">

### Integre com upload de avatar

No perfil (Aula 14), adicione um botÃ£o "Alterar Foto" que:
1. Abra o seletor de imagens do dispositivo
2. FaÃ§a upload para o Supabase Storage
3. Atualize a `avatar_url` do usuÃ¡rio via API
4. Recarregue o avatar com Coil

  </TabItem>
</Tabs>
