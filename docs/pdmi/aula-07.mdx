---
sidebar_position: 7
title: "Aula 07: Splash Screen e Auth Flow"
description: "SplashScreen com verificaÃ§Ã£o de autenticaÃ§Ã£o, AsyncStorage para persistÃªncia de token."
---

# Aula 07: Splash Screen e Auth Flow

:::info ðŸ”€ Branch da Aula
Esta aula refere-se Ã  branch: **`aula-07`**
```bash
git checkout aula-07
```
:::

## ðŸ“– Conceito

A **SplashScreen** Ã© o primeiro contato visual do usuÃ¡rio com o app. No MergeSkills, ela verifica se o usuÃ¡rio jÃ¡ estÃ¡ autenticado (token no AsyncStorage) e redireciona automaticamente.

### Arquivos novos nesta branch

| Arquivo | DescriÃ§Ã£o |
|---------|-----------|
| `lib/supabase.ts` | ConfiguraÃ§Ã£o do Supabase (adicionada nesta branch) |

## ðŸ’» CÃ³digo de ReferÃªncia

### SplashScreen com Auth Check

```tsx title="app/index.tsx"
import React, { useEffect } from 'react';
import { View, Text, StyleSheet, StatusBar } from 'react-native';
import { useRouter } from 'expo-router';
import Colors from '../constants/Colors';
import { apiClient } from '../lib/api';

export default function SplashScreen() {
    const router = useRouter();

    useEffect(() => {
        const checkAuth = async () => {
            await new Promise(resolve => setTimeout(resolve, 2000));

            try {
                const authenticated = await apiClient.auth.isAuthenticated();
                if (authenticated) {
                    router.replace('/(tabs)');
                } else {
                    router.replace('/login');
                }
            } catch (error) {
                console.error('Erro no checkAuth:', error);
                router.replace('/login');
            }
        };

        checkAuth();
    }, []);

    return (
        <View style={styles.container}>
            <StatusBar barStyle="light-content" />
            <View style={styles.logoContainer}>
                <View style={styles.logoSymbol}>
                    <Text style={styles.logoText}>M</Text>
                </View>
                <Text style={styles.brandName}>Merge Skills</Text>
            </View>
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: Colors.dark.background,
        justifyContent: 'center',
        alignItems: 'center'
    },
    logoSymbol: {
        width: 80, height: 80,
        backgroundColor: Colors.colors.stitchGreen,
        borderRadius: 20,
        justifyContent: 'center',
        alignItems: 'center',
        marginBottom: 16
    },
    logoText: {
        fontSize: 57, fontWeight: 'bold',
        color: Colors.dark.background
    },
    brandName: {
        fontSize: 32, fontWeight: '600',
        color: Colors.colors.stitchGreen,
        letterSpacing: 1
    }
});
```

### isAuthenticated no api.ts

```ts title="lib/api.ts (trecho)"
auth: {
    async isAuthenticated() {
        const token = await AsyncStorage.getItem(API_CONFIG.TOKEN_KEY);
        return !!token;
    }
}
```

## ðŸ’» MÃ£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>

### Adicione animaÃ§Ã£o ao logo

Use `Animated.Value` para fazer o logo aparecer com fade-in durante os 2 segundos de splash.

  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">

### Token persistence no signIn

Atualize `apiClient.auth.signIn` para salvar o `access_token` retornado pela API no `AsyncStorage`. Verifique que apÃ³s login â†’ fechar app â†’ reabrir, o splash redireciona direto para `(tabs)`.

  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">

### Logout com limpeza de token

Na tela de perfil, adicione um botÃ£o "Sair" que:
1. Chame `apiClient.auth.signOut()` (remove token do AsyncStorage)
2. Navegue para `/login` com `router.replace()`
3. Garanta que o back button nÃ£o retorne Ã  home

  </TabItem>
</Tabs>
