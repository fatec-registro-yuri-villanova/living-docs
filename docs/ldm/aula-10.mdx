---
sidebar_position: 10
title: "Aula 10: Storage e Upload"
description: "Upload de arquivos com Supabase Storage ‚Äî avatars, imagens de cursos."
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Aula 10: Storage e Upload
:::info üîÄ Branch da Aula
**`aula-10`** ‚Äî `git checkout aula-10`
:::
:::caution üöß Conte√∫do Prospectivo
Esta branch ainda n√£o possui c√≥digo implementado.
:::
## üìñ Conceito
O Supabase Storage permite upload/download de arquivos. O server recebe multipart form data via Ktor e armazena no bucket.
## üíª C√≥digo de Refer√™ncia
```kotlin title="server/.../routes/StorageRoutes.kt"
fun Route.storageRoutes(supabase: SupabaseClient) {
    post("/api/upload/avatar") {
        val multipart = call.receiveMultipart()
        multipart.forEachPart { part ->
            if (part is PartData.FileItem) {
                val bytes = part.streamProvider().readBytes()
                supabase.storage.from("avatars")
                    .upload("user_${userId}/${part.originalFileName}", bytes)
            }
            part.dispose()
        }
        call.respond(HttpStatusCode.OK)
    }
}
```
## üíª M√£o na Massa

<Tabs>
  <TabItem value="ex1" label="Exerc√≠cio 1 ‚Äî Fixa√ß√£o" default>
Implemente upload de avatar e retorne a URL p√∫blica do arquivo.
  </TabItem>
  <TabItem value="ex2" label="Exerc√≠cio 2 ‚Äî Aplica√ß√£o">
Adicione valida√ß√£o: apenas imagens (JPEG/PNG), m√°ximo 2MB.
  </TabItem>
  <TabItem value="ex3" label="Exerc√≠cio 3 ‚Äî Desafio">
Implemente redimensionamento de imagem no server antes do upload usando uma lib JVM.
  </TabItem>
</Tabs>
