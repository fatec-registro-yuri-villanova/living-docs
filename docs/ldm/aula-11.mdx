---
sidebar_position: 11
title: "Aula 11: Leaderboard API"
description: "Endpoint de ranking com ordenaÃ§Ã£o, paginaÃ§Ã£o e posiÃ§Ã£o do usuÃ¡rio."
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Aula 11: Leaderboard API
:::info ğŸ”€ Branch da Aula
**`aula-11`** â€” `git checkout aula-11`
:::
:::caution ğŸš§ ConteÃºdo Prospectivo
Esta branch ainda nÃ£o possui cÃ³digo implementado.
:::
## ğŸ“– Conceito
O leaderboard ordena usuÃ¡rios por XP total. O server calcula a posiÃ§Ã£o do usuÃ¡rio logado e retorna a lista paginada.
## ğŸ’» CÃ³digo de ReferÃªncia
```kotlin title="server/.../routes/LeaderboardRoutes.kt"
get("/api/leaderboard") {
    val limit = call.request.queryParameters["limit"]?.toIntOrNull() ?: 20
    val rankings = supabase.postgrest.from("user_stats")
        .select { order("total_xp", Order.DESCENDING); limit(limit.toLong()) }
        .decodeList<RankedUser>()
    call.respond(rankings.mapIndexed { i, u -> u.copy(position = i + 1) })
}
```
## ğŸ’» MÃ£o na Massa

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>
Implemente o endpoint e teste com dados seed no Supabase.
  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">
Adicione filtro por perÃ­odo (`?period=weekly`) usando `gte` no timestamp.
  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">
Adicione `GET /api/leaderboard/me` que retorna a posiÃ§Ã£o do usuÃ¡rio logado sem buscar o ranking inteiro.
  </TabItem>
</Tabs>
