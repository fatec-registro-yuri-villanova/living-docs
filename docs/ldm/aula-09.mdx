---
sidebar_position: 9
title: "Aula 09: Error Handling e Logging"
description: "Tratamento de erros no Ktor, StatusPages plugin, logging com Logback."
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Aula 09: Error Handling e Logging
:::info ðŸ”€ Branch da Aula
**`aula-09`** â€” `git checkout aula-09`
:::
:::caution ðŸš§ ConteÃºdo Prospectivo
Esta branch ainda nÃ£o possui cÃ³digo implementado.
:::
## ðŸ“– Conceito
O plugin `StatusPages` do Ktor intercepta exceÃ§Ãµes e retorna respostas padronizadas. Logback registra cada requisiÃ§Ã£o e erro para debugging.
## ðŸ’» CÃ³digo de ReferÃªncia
```kotlin title="server/.../plugins/ErrorHandling.kt"
fun Application.configureErrorHandling() {
    install(StatusPages) {
        exception<NotFoundException> { call, _ ->
            call.respond(HttpStatusCode.NotFound, ErrorResponse("Recurso nÃ£o encontrado"))
        }
        exception<BadRequestException> { call, cause ->
            call.respond(HttpStatusCode.BadRequest, ErrorResponse(cause.message ?: "RequisiÃ§Ã£o invÃ¡lida"))
        }
        exception<Throwable> { call, cause ->
            application.log.error("Erro interno", cause)
            call.respond(HttpStatusCode.InternalServerError, ErrorResponse("Erro interno do servidor"))
        }
    }
}
```
## ðŸ’» MÃ£o na Massa

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>
Adicione `StatusPages` ao `Application.module()` e teste com um endpoint que lanÃ§a exceÃ§Ã£o.
  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">
Configure Logback com rotaÃ§Ã£o de logs diÃ¡ria e formato JSON para produÃ§Ã£o.
  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">
Crie uma `@Serializable data class ErrorResponse` que inclua `code`, `message` e `timestamp` padronizados.
  </TabItem>
</Tabs>
