---
sidebar_position: 2
title: "Aula 02: Supabase Client Compartilhado"
description: "ConfiguraÃ§Ã£o do SupabaseClient no mÃ³dulo shared â€” Auth, Postgrest e Storage."
---

# Aula 02: Supabase Client Compartilhado

:::info ðŸ”€ Branch da Aula
Esta aula refere-se Ã  branch: **`aula-02`**
```bash
git checkout aula-02
```
:::

## ðŸ“– Conceito

O **Supabase Client** Ã© configurado no mÃ³dulo `shared/` para ser reutilizado em todas as plataformas (Server, Desktop, Mobile). Instala plugins de Auth, Postgrest (banco) e Storage (arquivos).

### Arquivo novo nesta branch

| Arquivo | DescriÃ§Ã£o |
|---------|-----------|
| `shared/.../SupabaseClient.kt` | Factory function do SupabaseClient compartilhado |

## ðŸ’» CÃ³digo de ReferÃªncia

### SupabaseClient â€” Factory Function

```kotlin title="shared/src/commonMain/kotlin/.../SupabaseClient.kt"
import io.github.jan.supabase.SupabaseClient
import io.github.jan.supabase.createSupabaseClient
import io.github.jan.supabase.gotrue.Auth
import io.github.jan.supabase.postgrest.Postgrest
import io.github.jan.supabase.serializer.KotlinXSerializer
import io.github.jan.supabase.storage.Storage
import kotlinx.serialization.json.Json

fun createAppSupabaseClient(
    supabaseUrl: String,
    supabaseKey: String
): SupabaseClient {
    return createSupabaseClient(
        supabaseUrl = supabaseUrl,
        supabaseKey = supabaseKey
    ) {
        install(Postgrest)
        install(Auth)
        install(Storage)

        defaultSerializer = KotlinXSerializer(Json {
            ignoreUnknownKeys = true
            prettyPrint = true
            isLenient = true
        })
    }
}
```

:::tip Shared = Reutilizado
Essa funÃ§Ã£o vive no `commonMain` â€” qualquer mÃ³dulo (server, desktop, mobile) pode chamÃ¡-la com suas credenciais especÃ­ficas. O server usa `System.getProperty()`, o mobile usa `BuildConfig`.
:::

## ðŸ’» MÃ£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>

Configure variÃ¡veis de ambiente `SUPABASE_URL` e `SUPABASE_KEY` no `build.gradle.kts` do server e instancie o client.

  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">

No servidor, crie um endpoint `GET /api/courses` que use `supabase.postgrest.from("courses").select()` para buscar dados reais.

  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">

Crie uma data class `Course` no `shared/` com `@Serializable` e use-a tanto no endpoint do server quanto na UI do ComposeApp para listar cursos.

  </TabItem>
</Tabs>
