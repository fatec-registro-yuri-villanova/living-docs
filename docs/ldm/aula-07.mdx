---
sidebar_position: 7
title: "Aula 07: Quiz API"
description: "Endpoints de quiz â€” buscar questÃµes, submeter respostas, validar server-side."
---

# Aula 07: Quiz API

:::info ðŸ”€ Branch da Aula
Esta aula refere-se Ã  branch: **`aula-07`** â€” `git checkout aula-07`
:::

:::caution ðŸš§ ConteÃºdo Prospectivo
Esta branch ainda nÃ£o possui cÃ³digo implementado.
:::

## ðŸ“– Conceito

O quiz Ã© validado no server â€” o client nunca recebe `correctIndex`. Ao submeter, o server compara e retorna o resultado.

## ðŸ’» CÃ³digo de ReferÃªncia

```kotlin title="server/.../routes/QuizRoutes.kt"
fun Route.quizRoutes(supabase: SupabaseClient) {
    route("/api/quiz/{lessonId}") {
        get("/questions") {
            val lessonId = call.parameters["lessonId"]!!
            val questions = supabase.postgrest.from("quiz_questions")
                .select { filter { eq("lesson_id", lessonId) } }
                .decodeList<QuizQuestionPublic>() // Sem correctIndex!
            call.respond(questions)
        }
        post("/submit") {
            val lessonId = call.parameters["lessonId"]!!
            val submission = call.receive<QuizSubmission>()
            // Busca as respostas corretas do banco
            val correct = supabase.postgrest.from("quiz_questions")
                .select { filter { eq("lesson_id", lessonId) } }
                .decodeList<QuizQuestionFull>()
            val score = calculateScore(submission.answers, correct)
            call.respond(QuizResult(score = score, total = correct.size))
        }
    }
}
```

## ðŸ’» MÃ£o na Massa

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
  <TabItem value="ex1" label="ExercÃ­cio 1 â€” FixaÃ§Ã£o" default>

Implemente `calculateScore()` que compara respostas e retorna acertos.

  </TabItem>
  <TabItem value="ex2" label="ExercÃ­cio 2 â€” AplicaÃ§Ã£o">

Adicione XP ao usuÃ¡rio baseado no score: `score * 10` XP por acerto.

  </TabItem>
  <TabItem value="ex3" label="ExercÃ­cio 3 â€” Desafio">

Implemente rate limiting â€” mÃ¡ximo 3 tentativas por quiz por dia.

  </TabItem>
</Tabs>
